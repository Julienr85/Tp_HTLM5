<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Bootstrap 101 Template</title>

    <!-- Bootstrap -->
    <!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  </head>
  <body>



    <div class="container">
		<!-- Affichage des informations de localisation et date -->
    	<div class="col-md-6 col-md-offset-3">
    		<div class="row">
    		    <div class="embed-responsive embed-responsive-16by9">
    				<br/><h1>screenShots 4...</h1><br/>
   		   			<video id="myVideo" autoplay></video>
   		   		</div>
    		</div>   
    		<div class="row">
    		    <div class="embed-responsive embed-responsive-16by9">
    				<br/><h1>Canvas</h1><br/>
   		   			<canvas id="myCanvas"></canvas>  
   		   		</div>
    		</div>
    		<div class="row">
    			<label for="informations">Informations</label>
				<div class="input-group">
 					 <span class="input-group-addon" id="basic-addon3">Latitude</span>
  			 		 <input type="text" class="form-control" id="information" aria-describedby="basic-addon3">
				</div>
				<div class="input-group">
 					 <span class="input-group-addon" id="basic-addon3">Longitude</span>
  			 		 <input type="text" class="form-control" id="information" aria-describedby="basic-addon3">
				</div>
				<div class="input-group">
 					 <span class="input-group-addon" id="basic-addon3">Date/Heure</span>
  			 	 	<input type="text" class="form-control" id="informations" aria-describedby="basic-addon3">
				</div>
		 	</div>
			<div class="row">
				<label>Op√©rations</label>
				<div class="btn-group btn-group-justified" role="group" aria-label="...">
  				<div class="btn-group" role="group">
   					 <button onclick="getLocation()" type="button" class="btn btn-default">Save</button>
  				</div>
 				<div class="btn-group" role="group">
  				  	<button id="demo" type="button" class="btn btn-default" onclick="getLocation()">Shoot</button>
 				</div>
  				<div class="btn-group" role="group">
    				<button type="button" class="btn btn-default">Reset</button>
 	    		</div>
			</div>
		</div>

	
    </div> <!-- /container -->
    


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!-- Script Geolocalisation -->
    <script>
      var x=document.getElementById("demo");        
      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
        }
        else {
          x.innerHTML="Geolocation is not supported by this browser.";
        }
        }
        function showPosition(position) {
          x.innerHTML="Latitude: " + position.coords.latitude + "<br/>Longitude: " + position.coords.longitude;           
        }
      </script>
    <!-- Script Canvas-->
    <script>
    
      window.URL = window.URL || window.webkitURL;
      navigator.getUserMedia  = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
      var video = document.getElementById("myVideo");
      var image = document.getElementById("myImage");      
      var canvas = document.getElementById("myCanvas");      
      canvas.width=500;
      canvas.height=300;
      var ctx = canvas.getContext('2d');
      ctx.fillStyle='#000000';
      ctx.fillRect(20,20,canvas.width,canvas.height);
      
      var myStream = null;
      
      var xStart=0;
      var yStart=0;
      
      var xStop=480;
      var yStop=480;
      
      var x=xStart;
      var y=yStart;
      
      function snapshot() {
        if (myStream) {
          // "image/webp" works in Chrome 18. In other browsers, this will fall back to image/png.
          image.src = canvas.toDataURL('image/webp');          
        }
      }
      
      video.addEventListener('click', snapshot, false);
                  
      function canvasPlayer() {
        if (myStream) {
          ctx.drawImage(video, 0, 0);
          var currentImage = ctx.getImageData(0, 0, canvas.width, canvas.height);
          var pixels = currentImage.data;
          // iterate over all pixels
          for(var i = 0, n = pixels.length; i < n; i += 4) {
            pixels[i + 0] = 0; // red
            //pixels[i + 1] = 0; // green
            //pixels[i + 2] = 0; // blue
            //pixels[i + 3] = 0; // alpha           
          }
          ctx.putImageData(currentImage,0, 0);           
          // draw a moving circle
          ctx.beginPath();
          ctx.arc(x++, y++, 10, 0, Math.PI*2, true);
          if (x>xStop) x=xStart;
          if (y>yStop) y=yStart;           
          ctx.closePath();
          ctx.fill();         
        }
      }
       
      if (navigator.getUserMedia) {
        navigator.getUserMedia(
          // Constraints
          {audio: true, video: true}, 
          // Success Callback
          function success(localMediaStream) {
            video.src = window.URL.createObjectURL(localMediaStream);
            myStream = localMediaStream;
            // call canvasPlayer every 20ms
            window.setInterval(canvasPlayer, 20);          
          }, 
          // Error Callback
          function fallback(err) {
            // Log the error to the console.
            console.log('The following error occurred when trying to use getUserMedia: ' + err);
          }
        );
        
      }
      else {
        alert('Sorry, your browser does not support getUserMedia');      
      }
    
    </script> 
 
  </body>
</html>